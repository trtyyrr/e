name: OKI Kernel Ultimate x SM8650 Full-Service
run-name: ğŸ—ï¸ OKI æ¶æ„ä¸€åŠ å¹³æ¿ Pro æ»¡è¡€æ„å»º [ç‰©ç†å…¨å±•å¼€] - ${{ github.actor }}

on:
  workflow_dispatch:

env:
  DEVICE_NAME: "OnePlusPadPro"
  KERNEL_VERSION: "6.1.118"
  # æ¢ç”¨ç›´é“¾ç¼–è¯‘å™¨ï¼Œç¡®ä¿ä¸‹è½½æˆåŠŸ
  CLANG_URL: "https://github.com/ZyCromerZ/Clang/releases/download/17.0.0-20231010-release/Clang-17.0.0-20231010.tar.gz"
  CLANG_ROOT: "${{ github.workspace }}/clang-oki"
  CCACHE_DIR: "${{ github.workspace }}/.ccache_oki"
  SOURCE_URL: "https://github.com/cctv18/android_kernel_common_oneplus_sm8650/archive/refs/heads/oneplus/sm8650_v_15.0.0_oneplus12_6.1.118.zip"

jobs:
  ultimate_oki_build:
    runs-on: ubuntu-latest
    steps:
      # ========================================================================
      # ç¬¬ä¸€é˜¶æ®µï¼šåŸå­åŒ–ç¯å¢ƒéƒ¨ç½² (ç»å¯¹ä¸åˆå¹¶å‘½ä»¤)
      # ========================================================================
      - name: ğŸ§¹ [Step 001] ç‰©ç†æ¸…ç† - Docker Image
        run: sudo docker image prune -a -f
      - name: ğŸ§¹ [Step 002] ç‰©ç†æ¸…ç† - Dotnet
        run: sudo rm -rf /usr/share/dotnet
      - name: ğŸ§¹ [Step 003] ç‰©ç†æ¸…ç† - Android SDK
        run: sudo rm -rf /usr/local/lib/android
      - name: ğŸ§¹ [Step 004] ç‰©ç†æ¸…ç† - GHC
        run: sudo rm -rf /opt/ghc
      - name: ğŸ§¹ [Step 005] ç‰©ç†æ¸…ç† - PowerShell
        run: sudo rm -rf /usr/local/share/powershell
      - name: ğŸ§¹ [Step 006] ç‰©ç†æ¸…ç† - Swift
        run: sudo rm -rf /usr/share/swift
      - name: ğŸ§¹ [Step 007] ç‰©ç†æ¸…ç† - NodeModules
        run: sudo rm -rf /usr/local/lib/node_modules
      - name: ğŸ§¹ [Step 008] ç‰©ç†æ¸…ç† - CloudSDK
        run: sudo rm -rf /usr/lib/google-cloud-sdk
      - name: ğŸ§¹ [Step 009] ç‰©ç†æ¸…ç† - AzureCLI
        run: sudo apt-get purge -y azure-cli
      - name: ğŸ§¹ [Step 010] ç‰©ç†æ¸…ç† - Mono
        run: sudo apt-get purge -y mono-devel
      - name: ğŸ§¹ [Step 011] ç‰©ç†æ¸…ç† - æœ€ç»ˆæ”¶å°¾
        run: sudo apt-get autoremove -y
      - name: ğŸ§¹ [Step 012] ç‰©ç†æ¸…ç† - ç¼“å­˜åˆ·æ–°
        run: sudo apt-get clean

      - name: ğŸ› ï¸ [Step 013] éƒ¨ç½²ä¾èµ– - bc
        run: sudo apt-get install -y bc
      - name: ğŸ› ï¸ [Step 014] éƒ¨ç½²ä¾èµ– - build-essential
        run: sudo apt-get install -y build-essential
      - name: ğŸ› ï¸ [Step 015] éƒ¨ç½²ä¾èµ– - flex
        run: sudo apt-get install -y flex
      - name: ğŸ› ï¸ [Step 016] éƒ¨ç½²ä¾èµ– - bison
        run: sudo apt-get install -y bison
      - name: ğŸ› ï¸ [Step 017] éƒ¨ç½²ä¾èµ– - libssl-dev
        run: sudo apt-get install -y libssl-dev
      - name: ğŸ› ï¸ [Step 018] éƒ¨ç½²ä¾èµ– - libelf-dev
        run: sudo apt-get install -y libelf-dev
      - name: ğŸ› ï¸ [Step 019] éƒ¨ç½²ä¾èµ– - python3
        run: sudo apt-get install -y python3
      - name: ğŸ› ï¸ [Step 020] éƒ¨ç½²ä¾èµ– - python3-dev
        run: sudo apt-get install -y python3-dev
      - name: ğŸ› ï¸ [Step 021] éƒ¨ç½²ä¾èµ– - curl
        run: sudo apt-get install -y curl
      - name: ğŸ› ï¸ [Step 022] éƒ¨ç½²ä¾èµ– - zip
        run: sudo apt-get install -y zip
      - name: ğŸ› ï¸ [Step 023] éƒ¨ç½²ä¾èµ– - unzip
        run: sudo apt-get install -y unzip
      - name: ğŸ› ï¸ [Step 024] éƒ¨ç½²ä¾èµ– - git
        run: sudo apt-get install -y git
      - name: ğŸ› ï¸ [Step 025] éƒ¨ç½²ä¾èµ– - ccache
        run: sudo apt-get install -y ccache
      - name: ğŸ› ï¸ [Step 026] éƒ¨ç½²ä¾èµ– - aria2
        run: sudo apt-get install -y aria2
      - name: ğŸ› ï¸ [Step 027] éƒ¨ç½²ä¾èµ– - pahole
        run: sudo apt-get install -y pahole
      - name: ğŸ› ï¸ [Step 028] éƒ¨ç½²ä¾èµ– - dwarves
        run: sudo apt-get install -y dwarves
      - name: ğŸ› ï¸ [Step 029] éƒ¨ç½²ä¾èµ– - kmod
        run: sudo apt-get install -y kmod
      - name: ğŸ› ï¸ [Step 030] éƒ¨ç½²ä¾èµ– - cpio
        run: sudo apt-get install -y cpio
      - name: ğŸ› ï¸ [Step 031] éƒ¨ç½²ä¾èµ– - rsync
        run: sudo apt-get install -y rsync
      - name: ğŸ› ï¸ [Step 032] éƒ¨ç½²ä¾èµ– - device-tree-compiler
        run: sudo apt-get install -y device-tree-compiler
      - name: ğŸ› ï¸ [Step 033] éƒ¨ç½²ä¾èµ– - lz4
        run: sudo apt-get install -y lz4
      - name: ğŸ› ï¸ [Step 034] éƒ¨ç½²ä¾èµ– - liblz4-tool
        run: sudo apt-get install -y liblz4-tool
      - name: ğŸ› ï¸ [Step 035] éƒ¨ç½²ä¾èµ– - zstd
        run: sudo apt-get install -y zstd

      # ========================================================================
      # ç¬¬äºŒé˜¶æ®µï¼šæºç ä¸å·¥å…·é“¾ç‰©ç†å¯¹é½
      # ========================================================================
      - name: ğŸ“¥ [Step 036] æºç å»ºç«‹ç›®å½•
        run: mkdir -p workspace
      - name: ğŸ“¥ [Step 037] æºç ä¸‹è½½æ‰§è¡Œ
        run: aria2c -s16 -x16 -k1M ${{ env.SOURCE_URL }} -o workspace/kernel.zip
      - name: ğŸ“¥ [Step 038] æºç è§£å‹èŠ‚ç‚¹
        run: unzip -q workspace/kernel.zip -d workspace/
      - name: ğŸ“¥ [Step 039] æºç ç‰©ç†æ›´å
        run: mv workspace/android_kernel_common_oneplus_sm8650-* workspace/common
      - name: ğŸ“¥ [Step 040] æ¸…ç†æºç å‹ç¼©åŒ…
        run: rm workspace/kernel.zip

      - name: ğŸ“¥ [Step 041] ç¼–è¯‘å™¨åˆ›å»ºç›®å½•
        run: mkdir -p ${{ env.CLANG_ROOT }}
      - name: ğŸ“¥ [Step 042] ç¼–è¯‘å™¨ä¸‹è½½æ‰§è¡Œ
        run: aria2c -s16 -x16 -k1M --user-agent="Mozilla/5.0" ${{ env.CLANG_URL }} -o clang.tar.gz
      - name: ğŸ“¥ [Step 043] ç¼–è¯‘å™¨ç‰©ç†å±•å¼€
        run: tar -C ${{ env.CLANG_ROOT }} -xzf clang.tar.gz
      - name: ğŸ“¥ [Step 044] æ¸…ç†ç¼–è¯‘å™¨å‹ç¼©åŒ…
        run: rm clang.tar.gz
      - name: ğŸ“¥ [Step 045] éªŒè¯ Clang ç‰ˆæœ¬
        run: ${{ env.CLANG_ROOT }}/bin/clang --version

      # ========================================================================
      # ç¬¬ä¸‰é˜¶æ®µï¼šOKI æ ¸å¿ƒé…ç½®ç‰©ç†æ³¨å…¥ (æ¯ä¸€è¡Œ CONFIG ç‹¬ç«‹å±•å¼€)
      # ========================================================================
      - name: âš™ï¸ [Step 046] OKI Config - æ³¨å…¥ TCP BBR
        run: echo "CONFIG_TCP_CONG_BBR=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 047] OKI Config - æ³¨å…¥é»˜è®¤ BBR
        run: echo "CONFIG_DEFAULT_TCP_CONG=\"bbr\"" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 048] OKI Config - æ³¨å…¥ FQ è°ƒåº¦
        run: echo "CONFIG_NET_SCH_FQ=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 049] OKI Config - æ³¨å…¥ FQ_CODEL
        run: echo "CONFIG_NET_SCH_FQ_CODEL=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 050] OKI Config - æ³¨å…¥ 1000Hz æ”¯æŒ
        run: echo "CONFIG_HZ_1000=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 051] OKI Config - ä¿®æ”¹ 1000Hz ç‰©ç†å€¼
        run: sed -i 's/CONFIG_HZ=250/CONFIG_HZ=1000/g' workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 052] OKI Config - æ³¨å…¥ WALT è°ƒåº¦
        run: echo "CONFIG_SCHED_WALT=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 053] OKI Config - æ³¨å…¥ ZRAM
        run: echo "CONFIG_ZRAM=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 054] OKI Config - æ³¨å…¥ ZRAM LZ4
        run: echo "CONFIG_ZRAM_DEF_COMP_LZ4=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 055] OKI Config - æ³¨å…¥ LZ4 å‹ç¼©
        run: echo "CONFIG_LZ4_COMPRESS=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 056] OKI Config - ç§»é™¤ LTO é™åˆ¶
        run: sed -i '/CONFIG_LTO_CLANG/d' workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 057] OKI Config - ç‰©ç†ç¦ç”¨ LTO
        run: echo "CONFIG_LTO_NONE=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 058] OKI Config - ç§»é™¤ BTF é™åˆ¶
        run: sed -i '/CONFIG_DEBUG_INFO_BTF/d' workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 059] OKI Config - ç‰©ç†ç¦ç”¨ BTF
        run: echo "CONFIG_DEBUG_INFO_BTF=n" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 060] OKI Config - ç‰©ç†å¼€å¯æ‰€æœ‰ç¬¦å·
        run: echo "CONFIG_UNUSED_SYMBOLS=y" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 061] OKI Config - ç‰©ç†ç¦ç”¨ç¬¦å·è£å‰ª
        run: echo "CONFIG_TRIM_UNUSED_KSYMS=n" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 062] OKI Config - ç‰©ç†ç¦ç”¨ CFI
        run: echo "CONFIG_CFI_CLANG=n" >> workspace/common/arch/arm64/configs/gki_defconfig
      - name: âš™ï¸ [Step 063] OKI Config - ç‰©ç†æ³¨å…¥è¶…çº§è°ƒåº¦å™¨
        run: echo "CONFIG_SCHED_AUTOGROUP=y" >> workspace/common/arch/arm64/configs/gki_defconfig

      # ========================================================================
      # ç¬¬å››é˜¶æ®µï¼šç‰©ç†é€»è¾‘æ³¨å…¥ (æ¯ä¸€è¡Œä»£ç ç‰©ç†ç”Ÿæˆ)
      # ========================================================================
      - name: ğŸ’‰ [Step 064] OKI Logic - åˆ›å»ºè°ƒåº¦ç›®å½•
        run: mkdir -p workspace/common/kernel/sched/
      - name: ğŸ’‰ [Step 065] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 1
        run: echo "#include <linux/sched.h>" > workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 066] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 2
        run: echo "#include <linux/cpumask.h>" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 067] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 3
        run: echo "#include <linux/module.h>" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 068] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 4
        run: echo "void apply_oki_policy(struct task_struct *p) {" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 069] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 5
        run: echo "  if (p && p->comm && (strstr(p->comm, \"surfaceflinger\") || strstr(p->comm, \"RenderThread\"))) {" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 070] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 6
        run: echo "    cpumask_t mask; cpumask_clear(&mask); cpumask_set_cpu(7, &mask);" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 071] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 7
        run: echo "    set_cpus_allowed_ptr(p, &mask);" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 072] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 8
        run: echo "  }" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 073] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 9
        run: echo "}" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 074] OKI Logic - ç”Ÿæˆä»£ç è¡Œ 10
        run: echo "EXPORT_SYMBOL_GPL(apply_oki_policy);" >> workspace/common/kernel/sched/oki_logic.c
      - name: ğŸ’‰ [Step 075] OKI Logic - ç‰©ç†æŒ‚è½½ Makefile
        run: echo "obj-y += oki_logic.o" >> workspace/common/kernel/sched/Makefile

      # ========================================================================
      # ç¬¬äº”é˜¶æ®µï¼šç¯å¢ƒå˜é‡ç‰©ç†å¹³é“º (æ’æ¯”å¥å±•å¼€)
      # ========================================================================
      - name: ğŸ—ï¸ [Step 076] ç¯å¢ƒ - ç‰©ç† PATH æ³¨å…¥
        run: echo "${{ env.CLANG_ROOT }}/bin" >> $GITHUB_PATH
      - name: ğŸ—ï¸ [Step 077] ç¯å¢ƒ - ç‰©ç† ARCH æ³¨å…¥
        run: echo "ARCH=arm64" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 078] ç¯å¢ƒ - ç‰©ç† SUBARCH æ³¨å…¥
        run: echo "SUBARCH=arm64" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 079] ç¯å¢ƒ - ç‰©ç† LLVM æ³¨å…¥
        run: echo "LLVM=1" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 080] ç¯å¢ƒ - ç‰©ç† LLVM_IAS æ³¨å…¥
        run: echo "LLVM_IAS=1" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 081] ç¯å¢ƒ - ç‰©ç† CROSS_COMPILE æ³¨å…¥
        run: echo "CROSS_COMPILE=aarch64-linux-gnu-" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 082] ç¯å¢ƒ - ç‰©ç† CROSS_COMPILE_ARM32 æ³¨å…¥
        run: echo "CROSS_COMPILE_ARM32=arm-linux-gnueabi-" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 083] ç¯å¢ƒ - ç‰©ç† CLANG_TRIPLE æ³¨å…¥
        run: echo "CLANG_TRIPLE=aarch64-linux-gnu-" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 084] ç¯å¢ƒ - ç‰©ç† CC æ³¨å…¥
        run: echo "CC=ccache clang" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 085] ç¯å¢ƒ - ç‰©ç† LD æ³¨å…¥
        run: echo "LD=ld.lld" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 086] ç¯å¢ƒ - ç‰©ç† AR æ³¨å…¥
        run: echo "AR=llvm-ar" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 087] ç¯å¢ƒ - ç‰©ç† NM æ³¨å…¥
        run: echo "NM=llvm-nm" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 088] ç¯å¢ƒ - ç‰©ç† OBJCOPY æ³¨å…¥
        run: echo "OBJCOPY=llvm-objcopy" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 089] ç¯å¢ƒ - ç‰©ç† OBJDUMP æ³¨å…¥
        run: echo "OBJDUMP=llvm-objdump" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 090] ç¯å¢ƒ - ç‰©ç† STRIP æ³¨å…¥
        run: echo "STRIP=llvm-strip" >> $GITHUB_ENV
      - name: ğŸ—ï¸ [Step 091] ç¯å¢ƒ - ç‰©ç† CCACHE_DIR æ³¨å…¥
        run: echo "CCACHE_DIR=${{ env.CCACHE_DIR }}" >> $GITHUB_ENV

      # ========================================================================
      # ç¬¬å…­é˜¶æ®µï¼šåŸå­åŒ–åˆ†æ­¥æ„å»º (ç¦æ­¢é“¾å¼å‘½ä»¤)
      # ========================================================================
      - name: ğŸ“‚ [Step 092] ç‰©ç†åŠ è½½ Ccache ç¼“å­˜
        uses: actions/cache@v4
        with:
          path: ${{ env.CCACHE_DIR }}
          key: oki-ccache-sm8650-epic-${{ github.sha }}
          restore-keys: oki-ccache-sm8650-epic-

      - name: ğŸ—ï¸ [Step 093] æ„å»º - åˆ›å»º Out ç›®å½•
        run: mkdir -p workspace/common/out
      - name: ğŸ—ï¸ [Step 094] æ„å»º - ç”Ÿæˆ GKI é…ç½®
        run: make -C workspace/common O=out ARCH=arm64 gki_defconfig
      - name: ğŸ—ï¸ [Step 095] æ„å»º - ç‰©ç†åŒæ­¥é…ç½® (olddefconfig)
        run: yes "" | make -C workspace/common O=out ARCH=arm64 olddefconfig
      - name: ğŸ—ï¸ [Step 096] æ„å»º - ç‰©ç†å¯¼å‡ºå¤´æ–‡ä»¶ (headers)
        run: make -C workspace/common O=out ARCH=arm64 headers_install
      - name: ğŸ—ï¸ [Step 097] æ„å»º - æ³¨å…¥ KCFLAGS å˜é‡
        run: echo "KCFLAGS=-march=armv8-a+crc+crypto -O3 -pipe" >> $GITHUB_ENV

      - name: ğŸ—ï¸ [Step 098] æ„å»º - å¯åŠ¨ä¸»é•œåƒç¼–è¯‘èŠ‚ç‚¹ 1
        run: echo "å¼€å§‹ç‰©ç†é“¾æ¥å†…æ ¸é•œåƒ..."
      - name: ğŸ—ï¸ [Step 099] æ„å»º - æ ¸å¿ƒæ‰§è¡Œ make Image
        run: make -j$(nproc) -C workspace/common O=out ARCH=arm64 V=1 Image 2>&1 | tee workspace/image_build.log
      - name: ğŸ—ï¸ [Step 100] æ„å»º - ç‰©ç†æ‰§è¡Œ make dtbs
        run: make -j$(nproc) -C workspace/common O=out ARCH=arm64 V=1 dtbs 2>&1 | tee workspace/dtbs_build.log
      - name: ğŸ—ï¸ [Step 101] æ„å»º - ç‰©ç†æ‰§è¡Œ make modules
        run: make -j$(nproc) -C workspace/common O=out ARCH=arm64 V=1 modules 2>&1 | tee workspace/modules_build.log

      # ========================================================================
      # ç¬¬ä¸ƒé˜¶æ®µï¼šæˆæœå°è£… (é€è¡Œç‰©ç†å¹³é“ºé€‚é…)
      # ========================================================================
      - name: ğŸ“¦ [Step 102] å°è£… - å…‹éš† AnyKernel3
        run: git clone --depth=1 https://github.com/osm0sis/AnyKernel3 workspace/ak3
      - name: ğŸ“¦ [Step 103] å°è£… - å®šä½ Image
        run: cp workspace/common/out/arch/arm64/boot/Image workspace/ak3/
      - name: ğŸ“¦ [Step 104] å°è£… - æŸ¥æ‰¾ DTB 1
        run: find workspace/common/out/arch/arm64/boot/dts/qcom/ -name "sm8650.dtb" -exec cp {} workspace/ak3/dtb \; || true
      - name: ğŸ“¦ [Step 105] å°è£… - æŸ¥æ‰¾ DTB 2
        run: find workspace/common/out/arch/arm64/boot/dts/qcom/ -name "*.dtb" -exec cp {} workspace/ak3/dtb \; || true
      - name: ğŸ“¦ [Step 106] å°è£… - ç‰©ç†é€‚é… AK3 è„šæœ¬ 1
        run: sed -i "s/device.name1=/device.name1=${{ env.DEVICE_NAME }}/g" workspace/ak3/anykernel.sh
      - name: ğŸ“¦ [Step 107] å°è£… - ç‰©ç†é€‚é… AK3 è„šæœ¬ 2
        run: sed -i "s/device.name2=/device.name2=OnePlus12/g" workspace/ak3/anykernel.sh
      - name: ğŸ“¦ [Step 108] å°è£… - ç‰©ç†é€‚é… AK3 è„šæœ¬ 3
        run: sed -i "s/device.name3=/device.name3=OP5929L1/g" workspace/ak3/anykernel.sh
      - name: ğŸ“¦ [Step 109] å°è£… - ç‰©ç†é€‚é… AK3 è„šæœ¬ 4
        run: sed -i "s/do.devicecheck=1/do.devicecheck=0/g" workspace/ak3/anykernel.sh

      - name: ğŸ“¦ [Step 110] å°è£… - å‹ç¼©æˆæœ
        run: cd workspace/ak3 && zip -r9 ../../OKI-Kernel-SM8650-Atomic-Epic.zip *

      - name: ğŸ“¤ [Step 111] å‘å¸ƒ - ä¸Šä¼ é•œåƒ
        uses: actions/upload-artifact@v4
        with:
          name: OKI-Epic-Image
          path: OKI-Kernel-SM8650-Atomic-Epic.zip
      - name: ğŸ“¤ [Step 112] å‘å¸ƒ - ä¸Šä¼ æ—¥å¿— 1
        uses: actions/upload-artifact@v4
        with:
          name: Build-Logs-Image
          path: workspace/image_build.log
      - name: ğŸ“¤ [Step 113] å‘å¸ƒ - ä¸Šä¼ æ—¥å¿— 2
        uses: actions/upload-artifact@v4
        with:
          name: Build-Logs-DTBS
          path: workspace/dtbs_build.log
      - name: ğŸ“¤ [Step 114] å‘å¸ƒ - ä¸Šä¼ é…ç½®
        uses: actions/upload-artifact@v4
        with:
          name: Kernel-Config
          path: workspace/common/out/.config

      - name: ğŸ“Š [Step 115] ç»Ÿè®¡ - ç‰©ç†æ‰“å°çŠ¶æ€
        run: ccache -s